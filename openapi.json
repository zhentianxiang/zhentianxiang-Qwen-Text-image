{"openapi":"3.1.0","info":{"title":"Qwen 多模态图像API服务","description":"集成文生图(Qwen-Image-2512)和图像编辑(Qwen-Image-Edit-2511)功能","version":"1.0.0"},"paths":{"/auth/users":{"get":{"tags":["认证"],"summary":"List Users","description":"获取所有用户列表（管理员）","operationId":"list_users_auth_users_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"skip","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Skip"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":100,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/UserResponse"},"title":"Response List Users Auth Users Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["认证"],"summary":"Create User Admin","description":"创建新用户（管理员）","operationId":"create_user_admin_auth_users_post","security":[{"HTTPBearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserAdminCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/users/{user_id}":{"put":{"tags":["认证"],"summary":"Update User Admin","description":"更新用户信息（管理员）","operationId":"update_user_admin_auth_users__user_id__put","security":[{"HTTPBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserAdminUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["认证"],"summary":"Delete User","description":"删除用户（管理员）","operationId":"delete_user_auth_users__user_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Delete User Auth Users  User Id  Delete"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/users/{user_id}/quota":{"get":{"tags":["认证"],"summary":"Get User Quota","description":"获取用户配额（管理员）","operationId":"get_user_quota_auth_users__user_id__quota_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/app__schemas__user__UserQuotaResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["认证"],"summary":"Update User Quota","description":"更新用户配额（管理员）","operationId":"update_user_quota_auth_users__user_id__quota_put","security":[{"HTTPBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserQuotaUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/app__schemas__user__UserQuotaResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/users/{user_id}/toggle-active":{"put":{"tags":["认证"],"summary":"Toggle User Active","description":"启用/禁用用户（管理员）","operationId":"toggle_user_active_auth_users__user_id__toggle_active_put","security":[{"HTTPBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Toggle User Active Auth Users  User Id  Toggle Active Put"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/users/{user_id}/toggle-admin":{"put":{"tags":["认证"],"summary":"Toggle User Admin","description":"设置/取消管理员权限（管理员）","operationId":"toggle_user_admin_auth_users__user_id__toggle_admin_put","security":[{"HTTPBearer":[]}],"parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Toggle User Admin Auth Users  User Id  Toggle Admin Put"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/text-to-image":{"post":{"tags":["文生图"],"summary":"Generate Image","description":"文生图端点：根据文本提示生成图像\n\n**异步模式** (async_mode=True，默认)：\n- 返回任务ID，通过 /tasks/{task_id} 查询状态\n- 通过 /tasks/{task_id}/result 获取结果\n- 适合长时间运行的任务，不会阻塞服务器\n\n**同步模式** (async_mode=False)：\n- 等待任务完成直接返回图像\n- 可能会较长时间等待响应\n\n参数说明：\n- **prompt**: 描述要生成的图像内容\n- **negative_prompt**: 描述不希望出现的内容\n- **aspect_ratio**: 图像宽高比，支持 1:1, 16:9, 9:16, 4:3, 3:4, 3:2, 2:3\n- **num_inference_steps**: 推理步数，越多质量越好但速度越慢\n- **true_cfg_scale**: CFG尺度，控制生成图像与提示的匹配程度\n- **seed**: 随机种子，用于复现结果\n- **num_images**: 生成图像数量\n- **async_mode**: 是否使用异步模式","operationId":"generate_image_text_to_image_post","requestBody":{"content":{"application/x-www-form-urlencoded":{"schema":{"$ref":"#/components/schemas/Body_generate_image_text_to_image_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/text-to-image/aspect-ratios":{"get":{"tags":["文生图"],"summary":"Get Aspect Ratios","description":"获取支持的宽高比及其对应尺寸","operationId":"get_aspect_ratios_text_to_image_aspect_ratios_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/image-edit":{"post":{"tags":["图像编辑"],"summary":"Edit Image","description":"图像编辑端点：基于上传的图像进行编辑\n\n**异步模式** (async_mode=True，默认)：\n- 返回任务ID，通过 /tasks/{task_id} 查询状态\n- 通过 /tasks/{task_id}/result 获取结果\n\n**同步模式** (async_mode=False)：\n- 等待任务完成直接返回图像\n\n参数说明：\n- **images**: 上传1-2张图像作为编辑基础\n- **prompt**: 描述要进行的编辑操作\n- **negative_prompt**: 描述不希望出现的内容\n- **num_inference_steps**: 推理步数\n- **true_cfg_scale**: CFG尺度\n- **guidance_scale**: 指导尺度\n- **seed**: 随机种子\n- **num_images**: 生成图像数量\n- **async_mode**: 是否使用异步模式","operationId":"edit_image_image_edit_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_edit_image_image_edit_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/image-edit/batch":{"post":{"tags":["图像编辑"],"summary":"Batch Edit","description":"批量编辑端点：对同一张图像应用多个编辑提示\n\n**异步模式** (async_mode=True，默认)：\n- 返回任务ID，通过 /tasks/{task_id} 查询状态\n- 通过 /tasks/{task_id}/result 获取结果\n\n**同步模式** (async_mode=False)：\n- 等待任务完成直接返回结果ZIP\n\n参数说明：\n- **image**: 上传单张图像\n- **prompts**: 多个编辑提示，用|分隔（例如：\"添加帽子|改变背景为海滩|添加太阳镜\"）\n- **negative_prompt**: 描述不希望出现的内容\n- **num_inference_steps**: 推理步数\n- **seed**: 随机种子\n- **async_mode**: 是否使用异步模式\n\n返回包含所有编辑结果的ZIP文件","operationId":"batch_edit_image_edit_batch_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_batch_edit_image_edit_batch_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/health":{"get":{"tags":["系统信息"],"summary":"Health Check","description":"健康检查端点\n\n返回服务状态和模型加载情况","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HealthResponse"}}}}}}},"/models":{"get":{"tags":["系统信息"],"summary":"List Models","description":"列出可用模型信息\n\n返回所有支持的模型及其状态","operationId":"list_models_models_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ModelsResponse"}}}}}}},"/aspect-ratios":{"get":{"tags":["系统信息"],"summary":"Get Aspect Ratios","description":"获取支持的宽高比\n\n返回所有支持的图像宽高比及其对应的像素尺寸","operationId":"get_aspect_ratios_aspect_ratios_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/memory":{"get":{"tags":["系统信息"],"summary":"Get Memory Status","description":"获取内存使用状态\n\n返回 CPU 和 GPU 内存的当前使用情况","operationId":"get_memory_status_memory_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/gpu":{"get":{"tags":["系统信息"],"summary":"Get Gpu Status","description":"获取 GPU 详细状态\n\n返回每个 GPU 的内存使用、使用率、温度、功耗等信息","operationId":"get_gpu_status_gpu_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/system":{"get":{"tags":["系统信息"],"summary":"Get System Status","description":"获取系统综合信息（仅管理员）\n\n返回 CPU、内存、GPU、操作系统、PyTorch 等完整系统信息","operationId":"get_system_status_system_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"HTTPBearer":[]}]}},"/tasks/queue":{"get":{"tags":["任务管理"],"summary":"Get Queue Info","description":"获取任务队列信息\n\n返回队列状态、GPU数量、并行度、各状态任务数量等\n统计数据仅针对当前用户","operationId":"get_queue_info_tasks_queue_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Response Get Queue Info Tasks Queue Get"}}}}},"security":[{"HTTPBearer":[]}]}},"/tasks/recycle-bin":{"get":{"tags":["任务管理"],"summary":"Get Recycle Bin","description":"获取回收站任务列表","operationId":"get_recycle_bin_tasks_recycle_bin_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"page","in":"query","required":false,"schema":{"type":"integer","minimum":1,"description":"页码","default":1,"title":"Page"},"description":"页码"},{"name":"page_size","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"description":"每页数量","default":20,"title":"Page Size"},"description":"每页数量"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskHistoryListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/tasks/{task_id}/delete":{"post":{"tags":["任务管理"],"summary":"Delete Task Soft","description":"删除任务（移入回收站）","operationId":"delete_task_soft_tasks__task_id__delete_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"task_id","in":"path","required":true,"schema":{"type":"string","title":"Task Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Delete Task Soft Tasks  Task Id  Delete Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/tasks/recycle-bin/{task_id}/restore":{"post":{"tags":["任务管理"],"summary":"Restore Task From Bin","description":"从回收站还原任务","operationId":"restore_task_from_bin_tasks_recycle_bin__task_id__restore_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"task_id","in":"path","required":true,"schema":{"type":"string","title":"Task Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Restore Task From Bin Tasks Recycle Bin  Task Id  Restore Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/tasks/recycle-bin/{task_id}":{"delete":{"tags":["任务管理"],"summary":"Delete Task Permanent","description":"永久删除任务","operationId":"delete_task_permanent_tasks_recycle_bin__task_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"task_id","in":"path","required":true,"schema":{"type":"string","title":"Task Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Delete Task Permanent Tasks Recycle Bin  Task Id  Delete"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/tasks/history/me":{"get":{"tags":["任务管理"],"summary":"Get My Task History","description":"获取当前用户的任务历史记录\n\n- **page**: 页码，从1开始\n- **page_size**: 每页数量，最大100\n- **status**: 状态过滤（pending/running/completed/failed/cancelled）\n- **task_type**: 任务类型过滤（text_to_image/image_edit/batch_edit）\n- **start_date**: 开始日期\n- **end_date**: 结束日期","operationId":"get_my_task_history_tasks_history_me_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"page","in":"query","required":false,"schema":{"type":"integer","minimum":1,"description":"页码","default":1,"title":"Page"},"description":"页码"},{"name":"page_size","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"description":"每页数量","default":20,"title":"Page Size"},"description":"每页数量"},{"name":"status","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"状态过滤","title":"Status"},"description":"状态过滤"},{"name":"task_type","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"任务类型过滤","title":"Task Type"},"description":"任务类型过滤"},{"name":"start_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"description":"开始日期","title":"Start Date"},"description":"开始日期"},{"name":"end_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"description":"结束日期","title":"End Date"},"description":"结束日期"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskHistoryListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/tasks/history/all":{"get":{"tags":["任务管理"],"summary":"Get All Tasks History","description":"获取所有任务历史记录（管理员）\n\n- **page**: 页码，从1开始\n- **page_size**: 每页数量，最大100\n- **status**: 状态过滤（pending/running/completed/failed/cancelled）\n- **task_type**: 任务类型过滤（text_to_image/image_edit/batch_edit）\n- **user_id**: 用户ID过滤\n- **start_date**: 开始日期\n- **end_date**: 结束日期","operationId":"get_all_tasks_history_tasks_history_all_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"page","in":"query","required":false,"schema":{"type":"integer","minimum":1,"description":"页码","default":1,"title":"Page"},"description":"页码"},{"name":"page_size","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"description":"每页数量","default":20,"title":"Page Size"},"description":"每页数量"},{"name":"status","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"状态过滤","title":"Status"},"description":"状态过滤"},{"name":"task_type","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"任务类型过滤","title":"Task Type"},"description":"任务类型过滤"},{"name":"user_id","in":"query","required":false,"schema":{"anyOf":[{"type":"integer"},{"type":"null"}],"description":"用户ID过滤","title":"User Id"},"description":"用户ID过滤"},{"name":"start_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"description":"开始日期","title":"Start Date"},"description":"开始日期"},{"name":"end_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"description":"结束日期","title":"End Date"},"description":"结束日期"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskHistoryListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/tasks/statistics/me":{"get":{"tags":["任务管理"],"summary":"Get My Statistics","description":"获取当前用户的任务统计信息\n\n返回任务数量统计、执行时间统计等","operationId":"get_my_statistics_tasks_statistics_me_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskStatistics"}}}}},"security":[{"HTTPBearer":[]}]}},"/tasks/statistics/global":{"get":{"tags":["任务管理"],"summary":"Get Global Statistics","description":"获取全局任务统计信息（管理员）\n\n返回全局任务数量统计、活跃用户数等","operationId":"get_global_statistics_tasks_statistics_global_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskStatistics"}}}}},"security":[{"HTTPBearer":[]}]}},"/tasks/quota/me":{"get":{"tags":["任务管理"],"summary":"Get My Quota","description":"获取当前用户的配额信息\n\n返回每日/每月限额、已用量、剩余量等","operationId":"get_my_quota_tasks_quota_me_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserQuotaResponse"}}}}},"security":[{"HTTPBearer":[]}]}},"/tasks/history/{task_id}":{"get":{"tags":["任务管理"],"summary":"Get Task History Detail","description":"获取任务历史详情\n\n- **task_id**: 任务ID\n\n返回任务的完整信息，包括参数、结果路径等","operationId":"get_task_history_detail_tasks_history__task_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"task_id","in":"path","required":true,"schema":{"type":"string","title":"Task Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Get Task History Detail Tasks History  Task Id  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/tasks/{task_id}":{"get":{"tags":["任务管理"],"summary":"Get Task Status","description":"获取任务状态\n\n- **task_id**: 任务ID（提交任务时返回）\n\n返回任务的详细状态信息，包括：\n- status: 任务状态（pending/running/completed/failed/cancelled）\n- position_in_queue: 在队列中的位置（仅等待中的任务）\n- wait_time_seconds: 等待时间\n- execution_time_seconds: 执行时间","operationId":"get_task_status_tasks__task_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"task_id","in":"path","required":true,"schema":{"type":"string","title":"Task Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Get Task Status Tasks  Task Id  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["任务管理"],"summary":"Cancel Task","description":"取消任务\n\n- **task_id**: 任务ID\n\n注意：只能取消等待中的任务，已开始执行的任务无法取消","operationId":"cancel_task_tasks__task_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"task_id","in":"path","required":true,"schema":{"type":"string","title":"Task Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Cancel Task Tasks  Task Id  Delete"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/tasks/{task_id}/result":{"get":{"tags":["任务管理"],"summary":"Get Task Result","description":"获取任务结果\n\n- **task_id**: 任务ID\n- **wait**: 是否等待任务完成\n- **timeout**: 等待超时时间（秒），默认300秒\n\n如果任务已完成，返回结果文件；\n如果任务未完成且 wait=False，返回当前状态；\n如果任务未完成且 wait=True，等待任务完成后返回结果。","operationId":"get_task_result_tasks__task_id__result_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"task_id","in":"path","required":true,"schema":{"type":"string","title":"Task Id"}},{"name":"wait","in":"query","required":false,"schema":{"type":"boolean","description":"是否等待任务完成","default":false,"title":"Wait"},"description":"是否等待任务完成"},{"name":"timeout","in":"query","required":false,"schema":{"type":"number","description":"等待超时时间（秒）","default":300.0,"title":"Timeout"},"description":"等待超时时间（秒）"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"title":"Response Get Task Result Tasks  Task Id  Result Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/tasks/cleanup":{"post":{"tags":["任务管理"],"summary":"Cleanup Tasks","description":"清理旧任务记录（管理员）\n\n- **max_age_hours**: 清理内存中超过指定小时数的已完成任务，默认24小时\n- **max_age_days**: 清理数据库中超过指定天数的已完成任务，默认30天\n\n清理已完成、失败或取消的旧任务记录以释放内存和存储空间","operationId":"cleanup_tasks_tasks_cleanup_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"max_age_hours","in":"query","required":false,"schema":{"type":"integer","description":"清理超过指定小时数的已完成任务（内存）","default":24,"title":"Max Age Hours"},"description":"清理超过指定小时数的已完成任务（内存）"},{"name":"max_age_days","in":"query","required":false,"schema":{"type":"integer","description":"清理超过指定天数的已完成任务（数据库）","default":30,"title":"Max Age Days"},"description":"清理超过指定天数的已完成任务（数据库）"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Cleanup Tasks Tasks Cleanup Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/":{"get":{"summary":"Root","description":"根路径 - 返回服务信息","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"Body_batch_edit_image_edit_batch_post":{"properties":{"image":{"type":"string","format":"binary","title":"Image","description":"上传的单张图像文件"},"prompts":{"type":"string","title":"Prompts","description":"多个编辑提示，用|分隔"},"negative_prompt":{"type":"string","title":"Negative Prompt","description":"不希望出现在图像中的内容","default":""},"num_inference_steps":{"type":"integer","maximum":100.0,"minimum":20.0,"title":"Num Inference Steps","description":"推理步数","default":40},"true_cfg_scale":{"type":"number","maximum":10.0,"minimum":1.0,"title":"True Cfg Scale","description":"CFG尺度参数","default":4.0},"seed":{"type":"integer","title":"Seed","description":"随机种子，-1表示随机生成","default":-1},"async_mode":{"type":"boolean","title":"Async Mode","description":"是否使用异步模式（返回任务ID）","default":true}},"type":"object","required":["image","prompts"],"title":"Body_batch_edit_image_edit_batch_post"},"Body_edit_image_image_edit_post":{"properties":{"images":{"items":{"type":"string","format":"binary"},"type":"array","title":"Images","description":"上传的图像文件（支持1-2张）"},"prompt":{"type":"string","title":"Prompt","description":"编辑图像的描述文本"},"negative_prompt":{"type":"string","title":"Negative Prompt","description":"不希望出现在图像中的内容","default":""},"num_inference_steps":{"type":"integer","maximum":100.0,"minimum":20.0,"title":"Num Inference Steps","description":"推理步数","default":40},"true_cfg_scale":{"type":"number","maximum":10.0,"minimum":1.0,"title":"True Cfg Scale","description":"CFG尺度参数","default":4.0},"guidance_scale":{"type":"number","maximum":10.0,"minimum":1.0,"title":"Guidance Scale","description":"指导尺度","default":1.0},"seed":{"type":"integer","title":"Seed","description":"随机种子，-1表示随机生成","default":-1},"num_images":{"type":"integer","maximum":4.0,"minimum":1.0,"title":"Num Images","description":"生成图像数量","default":1},"async_mode":{"type":"boolean","title":"Async Mode","description":"是否使用异步模式（返回任务ID）","default":true}},"type":"object","required":["images","prompt"],"title":"Body_edit_image_image_edit_post"},"Body_generate_image_text_to_image_post":{"properties":{"prompt":{"type":"string","title":"Prompt","description":"生成图像的描述文本"},"negative_prompt":{"type":"string","title":"Negative Prompt","description":"不希望出现在图像中的内容","default":""},"aspect_ratio":{"type":"string","title":"Aspect Ratio","description":"图像宽高比","default":"1:1"},"num_inference_steps":{"type":"integer","maximum":100.0,"minimum":20.0,"title":"Num Inference Steps","description":"推理步数","default":50},"true_cfg_scale":{"type":"number","maximum":10.0,"minimum":1.0,"title":"True Cfg Scale","description":"CFG尺度参数","default":4.0},"seed":{"type":"integer","title":"Seed","description":"随机种子，-1表示随机生成","default":-1},"num_images":{"type":"integer","maximum":4.0,"minimum":1.0,"title":"Num Images","description":"生成图像数量","default":1},"async_mode":{"type":"boolean","title":"Async Mode","description":"是否使用异步模式（返回任务ID）","default":true}},"type":"object","required":["prompt"],"title":"Body_generate_image_text_to_image_post"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"HealthResponse":{"properties":{"status":{"type":"string","title":"Status","description":"服务状态"},"text_to_image_model_loaded":{"type":"boolean","title":"Text To Image Model Loaded","description":"文生图模型是否加载"},"image_edit_model_loaded":{"type":"boolean","title":"Image Edit Model Loaded","description":"图像编辑模型是否加载"},"gpu_available":{"type":"boolean","title":"Gpu Available","description":"GPU是否可用"},"gpu_count":{"type":"integer","title":"Gpu Count","description":"GPU数量"}},"type":"object","required":["status","text_to_image_model_loaded","image_edit_model_loaded","gpu_available","gpu_count"],"title":"HealthResponse","description":"健康检查响应"},"ModelInfo":{"properties":{"name":{"type":"string","title":"Name","description":"模型名称"},"description":{"type":"string","title":"Description","description":"模型描述"},"capabilities":{"items":{"type":"string"},"type":"array","title":"Capabilities","description":"模型能力"},"status":{"type":"string","title":"Status","description":"模型状态"}},"type":"object","required":["name","description","capabilities","status"],"title":"ModelInfo","description":"模型信息"},"ModelsResponse":{"properties":{"text_to_image":{"$ref":"#/components/schemas/ModelInfo","description":"文生图模型信息"},"image_edit":{"$ref":"#/components/schemas/ModelInfo","description":"图像编辑模型信息"}},"type":"object","required":["text_to_image","image_edit"],"title":"ModelsResponse","description":"模型列表响应"},"TaskHistoryListResponse":{"properties":{"items":{"items":{"$ref":"#/components/schemas/TaskHistoryResponse"},"type":"array","title":"Items"},"total":{"type":"integer","title":"Total"},"page":{"type":"integer","title":"Page"},"page_size":{"type":"integer","title":"Page Size"},"total_pages":{"type":"integer","title":"Total Pages"}},"type":"object","required":["items","total","page","page_size","total_pages"],"title":"TaskHistoryListResponse","description":"任务历史列表响应"},"TaskHistoryResponse":{"properties":{"id":{"type":"integer","title":"Id"},"task_id":{"type":"string","title":"Task Id"},"user_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"User Id"},"task_type":{"type":"string","title":"Task Type"},"prompt":{"type":"string","title":"Prompt"},"negative_prompt":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Negative Prompt"},"parameters":{"additionalProperties":true,"type":"object","title":"Parameters","default":{}},"status":{"type":"string","title":"Status"},"result_path":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Result Path"},"result_filename":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Result Filename"},"error_message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error Message"},"created_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Created At"},"started_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Started At"},"completed_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Completed At"},"execution_time":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Execution Time"}},"type":"object","required":["id","task_id","task_type","prompt","status"],"title":"TaskHistoryResponse","description":"任务历史响应"},"TaskStatistics":{"properties":{"total_tasks":{"type":"integer","title":"Total Tasks","description":"总任务数"},"completed_tasks":{"type":"integer","title":"Completed Tasks","description":"完成任务数"},"failed_tasks":{"type":"integer","title":"Failed Tasks","description":"失败任务数"},"pending_tasks":{"type":"integer","title":"Pending Tasks","description":"等待中任务数"},"text_to_image_count":{"type":"integer","title":"Text To Image Count","description":"文生图任务数","default":0},"image_edit_count":{"type":"integer","title":"Image Edit Count","description":"图像编辑任务数","default":0},"batch_edit_count":{"type":"integer","title":"Batch Edit Count","description":"批量编辑任务数","default":0},"avg_execution_time":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Avg Execution Time","description":"平均执行时间（秒）"},"total_execution_time":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Total Execution Time","description":"总执行时间（秒）"}},"type":"object","required":["total_tasks","completed_tasks","failed_tasks","pending_tasks"],"title":"TaskStatistics","description":"任务统计"},"UserAdminCreate":{"properties":{"username":{"type":"string","maxLength":50,"minLength":3,"title":"Username"},"password":{"type":"string","maxLength":100,"minLength":6,"title":"Password"},"email":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Email"},"is_admin":{"type":"boolean","title":"Is Admin","default":false}},"type":"object","required":["username","password"],"title":"UserAdminCreate","description":"管理员创建用户"},"UserAdminUpdate":{"properties":{"email":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Email"},"password":{"anyOf":[{"type":"string","maxLength":100,"minLength":6},{"type":"null"}],"title":"Password"},"is_active":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is Active"},"is_admin":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is Admin"}},"type":"object","title":"UserAdminUpdate","description":"管理员更新用户"},"UserQuotaResponse":{"properties":{"user_id":{"type":"integer","title":"User Id"},"daily_limit":{"type":"integer","title":"Daily Limit","description":"每日限额"},"monthly_limit":{"type":"integer","title":"Monthly Limit","description":"每月限额"},"used_today":{"type":"integer","title":"Used Today","description":"今日已用"},"used_this_month":{"type":"integer","title":"Used This Month","description":"本月已用"},"total_used":{"type":"integer","title":"Total Used","description":"总使用量"},"remaining_today":{"type":"integer","title":"Remaining Today","description":"今日剩余"},"remaining_this_month":{"type":"integer","title":"Remaining This Month","description":"本月剩余"}},"type":"object","required":["user_id","daily_limit","monthly_limit","used_today","used_this_month","total_used","remaining_today","remaining_this_month"],"title":"UserQuotaResponse","description":"用户配额响应"},"UserQuotaUpdate":{"properties":{"daily_limit":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Daily Limit"},"monthly_limit":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Monthly Limit"}},"type":"object","title":"UserQuotaUpdate","description":"配额更新"},"UserResponse":{"properties":{"id":{"type":"integer","title":"Id"},"username":{"type":"string","title":"Username"},"email":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Email"},"is_active":{"type":"boolean","title":"Is Active"},"is_admin":{"type":"boolean","title":"Is Admin"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["id","username","is_active","is_admin","created_at"],"title":"UserResponse","description":"用户信息响应"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"},"app__schemas__user__UserQuotaResponse":{"properties":{"user_id":{"type":"integer","title":"User Id"},"daily_limit":{"type":"integer","title":"Daily Limit"},"monthly_limit":{"type":"integer","title":"Monthly Limit"},"used_today":{"type":"integer","title":"Used Today"},"used_this_month":{"type":"integer","title":"Used This Month"},"total_used":{"type":"integer","title":"Total Used"},"remaining_today":{"type":"integer","title":"Remaining Today"},"remaining_this_month":{"type":"integer","title":"Remaining This Month"}},"type":"object","required":["user_id","daily_limit","monthly_limit","used_today","used_this_month","total_used","remaining_today","remaining_this_month"],"title":"UserQuotaResponse","description":"配额信息响应"}},"securitySchemes":{"HTTPBearer":{"type":"http","scheme":"bearer"}}}}